<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:gui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:jsp="http://java.sun.com/JSP/Page"
      xmlns:ice="http://www.icesoft.com/icefaces/component">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
</head>
<body>
  <gui:composition template="/template.xhtml">
    <gui:param name="pageTitle" value="DVN - Review Studies"/>
    <gui:define name="body">
      <ice:form>
        <ice:inputHidden id="vdcId" value="#{VDCRequest.currentVDCId}"/>
        <div class="dvn_section">
          <div jsfc="ice:panelGroup" styleClass="dvnMsgBlockRound dvnInformationMessage">
            <div class="dvnMsgBlockContainer">
              <ice:outputText value="When curators or admins add a study, the study is set to 'In Review' by default. Set it to 'Released' if it's ready for users to see it (once study is released, it's not displayed in this page anymore). A study status is set to 'New' when a contributor adds a study. A curator or admin can set to 'In Review' and, when ready, set it to 'Released'. Click the study name to go to the study page and edit/delete options for that study." escape="false"/>
            </div>
          </div>
          <div class="dvn_sectionTitle">
            <ice:outputText value="Review Studies in #{VDCRequest.currentVDC.name} Dataverse"/>
          </div>
          <div class="dvn_sectionBox">
            <div class="dvn_margin12">
              <ice:dataTable cellpadding="0" cellspacing="0" width="100%"
                             headerClass="list-header-left vdcColPadded" id="dataTable1" columnClasses="vdcReviewCol1, vdcReviewCol2, vdcReviewCol3, vdcReviewCol4, vdcReviewCol5, vdcReviewCol6"
                             rowClasses="list-row-even vdcColPadded, list-row-odd vdcColPadded" value="#{ReviewStudiesPage.reviewStudies}"
                             var="currentRow">
                <ice:column id="column1">
                  <f:facet name="header">
                    <ice:outputText id="outputText2" value="Studies in Review"/>
                  </f:facet>
                  <ice:outputLink id="hyperlink1" value="/dvn/dv/#{VDCRequest.currentVDC.alias}/faces/study/StudyPage.xhtml?studyId=#{currentRow[0]}">
                    <ice:outputText id="hyperlink1Text1" value="#{currentRow[1]} - #{currentRow[2]}"/>
                  </ice:outputLink>
                </ice:column>
                <ice:column id="column2">
                  <ice:outputText styleClass="vdcStudyStatus" value="Upload in Progress" rendered="#{currentRow[10]!=null}"/>
                  <ice:selectOneMenu value="#{currentRow[3]}" id="dropdown1" disabled="#{currentRow[10] != null }">
                    <!--
                    <f:selectItems  id="dropdown1SelectItems" value="#{ReviewStudiesPage.dropdown1DefaultItems}"/>
                    -->
                    <f:selectItems id="dropdown1SelectItems" value="#{currentRow[3] == 'New' ?  ReviewStudiesPage.dropdown1NewItems : ReviewStudiesPage.dropdown1InReviewItems}"/>
                  </ice:selectOneMenu>
                  <f:facet name="header">
                    <ice:outputText id="outputText4" value="Status"/>
                  </f:facet>
                </ice:column>
                <ice:column id="column3">
                  <ice:outputLink id="hyperlink2" value="/dvn#{VDCRequest.currentVDCURL}/faces/login/AccountPage.xhtml?userId=#{currentRow[6]}">
                    <ice:outputText id="hyperlink2Text" value="#{currentRow[4]}"/>
                  </ice:outputLink>
                  <f:facet name="header">
                    <ice:outputText id="outputText3" value="Contributor"/>
                  </f:facet>
                </ice:column>
                <ice:column id="column4">
                  <ice:outputLink id="hyperlink3" value="/dvn#{VDCRequest.currentVDCURL}/faces/login/AccountPage.xhtml?userId=#{currentRow[7]}">
                    <ice:outputText id="hyperlink2Text1" value="#{currentRow[5]}"/>
                  </ice:outputLink>
                  <f:facet name="header">
                    <ice:outputText id="outputText5" value="Reviewer"/>
                  </f:facet>
                </ice:column>
                <ice:column id="column5">
                  <f:facet name="header">
                    <ice:outputText id="createdDate" value="Created Date"/>
                  </f:facet>
                  <ice:outputText id="CreatedDateText" value="#{currentRow[8]}"/>
                </ice:column>
                <ice:column id="column6">
                  <f:facet name="header">
                    <ice:outputText id="lastModifiedDate" value="Last Modified Date"/>
                  </f:facet>
                  <ice:outputText id="LastModifiedDateText" value="#{currentRow[9]}"/>
                </ice:column>
              </ice:dataTable>
              <ice:dataTable cellpadding="0" cellspacing="0" width="100%"
                             headerClass="list-header-left vdcColPadded" columnClasses="vdcReviewCol1, vdcReviewCol2, vdcReviewCol3, vdcReviewCol4, vdcReviewCol5, vdcReviewCol6"
                             rowClasses="list-row-even vdcColPadded, list-row-odd vdcColPadded" value="#{ReviewStudiesPage.newStudies}" rendered="#{ReviewStudiesPage.newStudies.rowCount > 0 }"
                             var="currentRow">
                <ice:column>
                  <f:facet name="header">
                    <ice:outputText value="New Studies"/>
                  </f:facet>
                  <ice:outputLink value="/dvn/dv/#{VDCRequest.currentVDC.alias}/faces/study/StudyPage.xhtml?studyId=#{currentRow[0]}">
                    <ice:outputText value="#{currentRow[1]} - #{currentRow[2]}"/>
                  </ice:outputLink>
                </ice:column>
                <ice:column>
                  <ice:outputLink value="/dvn#{VDCRequest.currentVDCURL}/faces/login/AccountPage.xhtml?userId=#{currentRow[6]}">
                    <ice:outputText value="#{currentRow[4]}"/>
                  </ice:outputLink>
                  <f:facet name="header">
                    <ice:outputText  value="Contributor"/>
                  </f:facet>
                </ice:column>
                <ice:column>
                  <ice:outputLink value="/dvn#{VDCRequest.currentVDCURL}/faces/login/AccountPage.xhtml?userId=#{currentRow[7]}">
                    <ice:outputText value="#{currentRow[5]}"/>
                  </ice:outputLink>
                  <f:facet name="header">
                    <ice:outputText value="Reviewer"/>
                  </f:facet>
                </ice:column>
                <ice:column>
                  <f:facet name="header">
                    <ice:outputText value="Created Date"/>
                  </f:facet>
                  <ice:outputText value="#{currentRow[8]}"/>
                </ice:column>
                <ice:column>
                  <f:facet name="header">
                    <ice:outputText value="Last Modified Date"/>
                  </f:facet>
                  <ice:outputText value="#{currentRow[9]}"/>
                </ice:column>
              </ice:dataTable>
              <div jsfc="ice:panelGroup" styleClass="dvnFormPadding" rendered="#{ReviewStudiesPage.displayNoStudiesText}">
                <ice:outputText id="noStudiesText" value="There are currently no New studies or studies In Review." styleClass="warnMessage"/>
              </div>
              <div class="dvnFormPadding">
                <ice:commandButton  id="button1" value="Update" actionListener="#{ReviewStudiesPage.updateStudy}"/>
              </div>
            </div>
          </div>
        </div>
      </ice:form>
    </gui:define>
  </gui:composition>
</body>
</html>
